{"ast":null,"code":"var _jsxFileName = \"/home/minhyuk/\\uBC14\\uD0D5\\uD654\\uBA74/Final Project/JoopJoop/client/src/app.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from \"react\";\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport Navbar from \"./components/navbar\";\nimport Chat from \"./pages/chat\";\nimport Community from \"./pages/community\";\nimport Home from \"./pages/home\";\nimport Schedule from \"./pages/schedule\";\nimport Footer from \"./components/footer\";\nimport Landing from \"./pages/landing\";\nimport \"./index.css\";\nimport Dropdown from \"./components/dropdown\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport action from \"./redux/action\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst mapStateToProps = state => {\n  return {\n    isLogin: state.isLogin\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setIsLogin: boolean => dispatch(action.setIsLogin(boolean))\n  };\n};\n\nfunction App(_ref) {\n  _s();\n\n  let {\n    isLogin,\n    setIsLogin\n  } = _ref;\n\n  const onLogin = (email, password) => {\n    console.log(\"로그인요청\");\n    const data = {\n      email,\n      password\n    };\n    axios.post(\"http://localhost:80/auth/login\", data, {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      withCredentials: true,\n      HttpOnly: true,\n      samesite: \"Secure\"\n    }).then(res => {\n      onLoginSuccess(res);\n    }).catch(error => {\n      console.log(\"onLogin 함수\");\n    });\n  };\n\n  const onSilentRefresh = () => {\n    axios.post(\"http://localhost:80/auth/refresh\", {\n      data: \"refresh\"\n    }, {\n      withCredentials: true\n    }).then(res => {\n      onLoginSuccess(res);\n      console.log(\"resfresh 성공\");\n    }).catch(error => {\n      console.log(\"refresh 실패\");\n      setIsLogin(false);\n    });\n  };\n\n  const onLoginSuccess = res => {\n    const {\n      accessToken\n    } = res.data; // console.log(\"onloginsuccess\");\n    // console.log(accessToken);\n    //login state true\n\n    setIsLogin(true); // accessToken 설정\n\n    axios.defaults.headers.common[\"token\"] = accessToken; // accessToken 만료하기 1분 전에 로그인 연장\n    // setTimeout(onSilentRefresh, JWT_EXPIRRY_TIME - 60000);\n    // getGatherings(accessToken);\n  }; //! gatherings 정보가져오기, 분리 필요\n  // const getGatherings = () => {\n  //   axios\n  //     .get(\"http://localhost:80/gatherings\", {\n  //       withCredentials: true,\n  //       token: accessToken,\n  //     })\n  //     .then(data => console.log(data));\n  // };\n\n\n  const componentDidMount = () => {\n    onSilentRefresh();\n  };\n\n  componentDidMount();\n  const [isOpen, setIsOpen] = useState(false);\n\n  const toggle = () => {\n    setIsOpen(!isOpen);\n  };\n\n  useEffect(() => {\n    const hideMenu = () => {\n      if (window.innerWidth > 768 && isOpen) {\n        setIsOpen(false);\n        console.log(\"i resized\");\n      }\n    };\n\n    window.addEventListener(\"resize\", hideMenu);\n    return () => {\n      window.removeEventListener(\"resize\", hideMenu);\n    };\n  });\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(BrowserRouter, {\n      children: [/*#__PURE__*/_jsxDEV(Dropdown, {\n        isOpen: isOpen,\n        toggle: toggle\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 9\n      }, this), isLogin ? /*#__PURE__*/_jsxDEV(Navbar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 20\n      }, this) : null, isLogin ? /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          path: \"/home\",\n          exact: true,\n          component: Home\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/schedule\",\n          component: Schedule\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/chat\",\n          component: Chat\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/community\",\n          component: Community\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(Landing, {\n        onLogin: onLogin\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(App, \"vl0Rt3/A8evyRPW1OQ1AhRk4UhU=\");\n\n_c = App;\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useEffect","useState","BrowserRouter","Route","Switch","Navbar","Chat","Community","Home","Schedule","Footer","Landing","Dropdown","axios","connect","action","mapStateToProps","state","isLogin","mapDispatchToProps","dispatch","setIsLogin","boolean","App","onLogin","email","password","console","log","data","post","headers","withCredentials","HttpOnly","samesite","then","res","onLoginSuccess","catch","error","onSilentRefresh","accessToken","defaults","common","componentDidMount","isOpen","setIsOpen","toggle","hideMenu","window","innerWidth","addEventListener","removeEventListener"],"sources":["/home/minhyuk/바탕화면/Final Project/JoopJoop/client/src/app.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport Navbar from \"./components/navbar\";\nimport Chat from \"./pages/chat\";\nimport Community from \"./pages/community\";\nimport Home from \"./pages/home\";\nimport Schedule from \"./pages/schedule\";\nimport Footer from \"./components/footer\";\nimport Landing from \"./pages/landing\";\nimport \"./index.css\";\nimport Dropdown from \"./components/dropdown\";\nimport axios from \"axios\";\nimport { connect } from \"react-redux\";\nimport action from \"./redux/action\";\n\nconst mapStateToProps = state => {\n  return {\n    isLogin: state.isLogin,\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    setIsLogin: boolean => dispatch(action.setIsLogin(boolean)),\n  };\n};\n\nfunction App({ isLogin, setIsLogin }) {\n  const onLogin = (email, password) => {\n    console.log(\"로그인요청\");\n    const data = {\n      email,\n      password,\n    };\n    axios\n      .post(\"http://localhost:80/auth/login\", data, {\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        withCredentials: true,\n        HttpOnly: true,\n        samesite: \"Secure\",\n      })\n      .then(res => {\n        onLoginSuccess(res);\n      })\n      .catch(error => {\n        console.log(\"onLogin 함수\");\n      });\n  };\n\n  const onSilentRefresh = () => {\n    axios\n      .post(\n        \"http://localhost:80/auth/refresh\",\n        { data: \"refresh\" },\n        {\n          withCredentials: true,\n        },\n      )\n      .then(res => {\n        onLoginSuccess(res);\n        console.log(\"resfresh 성공\");\n      })\n      .catch(error => {\n        console.log(\"refresh 실패\");\n        setIsLogin(false);\n      });\n  };\n\n  const onLoginSuccess = res => {\n    const { accessToken } = res.data;\n    // console.log(\"onloginsuccess\");\n    // console.log(accessToken);\n    //login state true\n    setIsLogin(true);\n    // accessToken 설정\n    axios.defaults.headers.common[\"token\"] = accessToken;\n    // accessToken 만료하기 1분 전에 로그인 연장\n    // setTimeout(onSilentRefresh, JWT_EXPIRRY_TIME - 60000);\n    // getGatherings(accessToken);\n  };\n\n  //! gatherings 정보가져오기, 분리 필요\n  // const getGatherings = () => {\n  //   axios\n  //     .get(\"http://localhost:80/gatherings\", {\n  //       withCredentials: true,\n  //       token: accessToken,\n  //     })\n  //     .then(data => console.log(data));\n  // };\n\n  const componentDidMount = () => {\n    onSilentRefresh();\n  };\n  componentDidMount();\n\n  const [isOpen, setIsOpen] = useState(false);\n\n  const toggle = () => {\n    setIsOpen(!isOpen);\n  };\n\n  useEffect(() => {\n    const hideMenu = () => {\n      if (window.innerWidth > 768 && isOpen) {\n        setIsOpen(false);\n        console.log(\"i resized\");\n      }\n    };\n    window.addEventListener(\"resize\", hideMenu);\n    return () => {\n      window.removeEventListener(\"resize\", hideMenu);\n    };\n  });\n\n  return (\n    <>\n      <BrowserRouter>\n        <Dropdown isOpen={isOpen} toggle={toggle} />\n        {isLogin ? <Navbar /> : null}\n        {isLogin ? (\n          <Switch>\n            <Route path=\"/home\" exact component={Home} />\n            <Route path=\"/schedule\" component={Schedule} />\n            <Route path=\"/chat\" component={Chat} />\n            <Route path=\"/community\" component={Community} />\n          </Switch>\n        ) : (\n          <Landing onLogin={onLogin} />\n        )}\n        <Footer></Footer>\n      </BrowserRouter>\n    </>\n  );\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(App);\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}